"0","# Função para calcular o Beta"
"2","There were 11 warnings (use warnings() to see them)"
"2","
"
"0","calcular_beta <- function(x) {"
"0","  RExc.ibov <- x$R.ibov - x$R.selic"
"0","  RExc.ativo1 <- x$R.ativo1 - x$R.selic"
"0","  RExc.ativo2 <- x$R.ativo2 - x$R.selic"
"0","  RExc.ativo3 <- x$R.ativo3 - x$R.selic"
"0","  RExc.ativo4 <- x$R.ativo4 - x$R.selic"
"0","  RExc.ativo5 <- x$R.ativo5 - x$R.selic"
"0","  "
"0","  # Beta - inclinação da regressão"
"0","  reg.ativo1 <- lm(RExc.ativo1 ~ RExc.ibov)"
"0","  reg.ativo2 <- lm(RExc.ativo2 ~ RExc.ibov)"
"0","  reg.ativo3 <- lm(RExc.ativo3 ~ RExc.ibov)"
"0","  reg.ativo4 <- lm(RExc.ativo4 ~ RExc.ibov)"
"0","  reg.ativo5 <- lm(RExc.ativo5 ~ RExc.ibov)"
"0",""
"0","  beta.ativos <- c(reg.ativo1$coef[2], reg.ativo2$coef[2], reg.ativo3$coef[2], reg.ativo4$coef[2],reg.ativo5$coef[2])"
"0",""
"0","  names(beta.ativos) <- codigos"
"0","   "
"0","  # Rf(1-Beta) - Ponto de interceptação da regressão"
"0","  intercept.ativos <- c(reg.ativo1$coef[1], reg.ativo2$coef[1],reg.ativo3$coef[1], reg.ativo4$coef[1], reg.ativo5$coef[1])"
"0",""
"0","  names(intercept.ativos) <- codigos"
"0",""
"0","  # R2 - Medida da qualidade da regressão"
"0","  r2 <- function(x) {"
"0","  r2.temp <- summary(x)"
"0","  return(r2.temp$adj.r.squared)"
"0","  }"
"0",""
"0","  r2.ativos <- c(r2(reg.ativo1), r2(reg.ativo2), r2(reg.ativo3), r2(reg.ativo4), r2(reg.ativo5))"
"0","  names(r2.ativos) <- codigos"
"0","  "
"0",""
"0","  return(list(Betas = beta.ativos, Intercepto = intercept.ativos, R2 = r2.ativos))"
"0","}"
