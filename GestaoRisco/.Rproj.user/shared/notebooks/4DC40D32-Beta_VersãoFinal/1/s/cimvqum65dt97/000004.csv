"0","nomes.colunas <- names(df.retornos)"
"0",""
"0","# função beta"
"0","calcular_beta <- function(dados, i) {"
"0","  "
"0","  # objetos temporarios"
"0","  betas <- NULL"
"0","  interceptos <- NULL"
"0","  r2.ajustado <- NULL"
"0","  "
"0","  r2 <- function(x) {"
"0","  r2.temp <- summary(x)"
"0","  return(r2.temp$adj.r.squared)"
"0","  }"
"0","  "
"0","  empresa <- nomes.colunas[i]"
"0","  ret.excedente <- dados - dados$selic"
"0","  "
"0","  ret.excedente['selic'] <- NULL"
"0",""
"0","  reg.temp <- lm(ret.excedente[[empresa]]~ret.excedente$ibov)"
"0","    "
"0","  betas[empresa] <- reg.temp$coef[2]"
"0","  interceptos[empresa] <- reg.temp$coef[1]"
"0","  "
"0","  # R2 - Medida da qualidade da regressão"
"0",""
"0","  r2.ajustado[empresa] <- r2(reg.temp)"
"0",""
"0","  return(list(Betas = betas, Intercepto = interceptos, R2 = r2.ajustado))"
"0","}"
