"0","betas <- NULL"
"0","interceptos <- NULL"
"0","nomes.colunas <- names(df.retornos)"
"0","r2.ajustado <- NULL"
"0",""
"0","# funÃ§Ã£o beta"
"0","calcular_beta <- function(dados, i) {"
"0","  "
"0","  r2 <- function(x) {"
"0","  r2.temp <- summary(x)"
"0","  return(r2.temp$adj.r.squared)"
"0","  }"
"0","  "
"0","  empresa <- nomes.colunas[i]"
"0","  ret.excedente <- dados - dados$selic"
"0","  "
"0","  ret.excedente['selic'] <- NULL"
"0",""
"0","  reg.temp <- lm(ret.excedente[[empresa]]~ret.excedente$ibov)"
"0","    "
"0","  betas[empresa] <- reg.temp$coef[2]"
"0","  interceptos[empresa] <- reg.temp$coef[1]"
"0","  "
"0","  # R2 - Medida da qualidade da regressÃ£o"
"0",""
"0","  r2.ajustado[empresa] <- r2(reg.temp)"
"0",""
"0","  return(list(Betas = betas, Intercepto = interceptos, R2 = r2.ajustado))"
"0","}"
"0",""
"0",""
"0","calcular_beta(df.retornos.selic, 2)"
"1","$Betas
"
"1"," CPLE6.SA "
"1","
"
"1","0.7147051 "
"1","
"
"1","
"
"1","$Intercepto
"
"1","   CPLE6.SA "
"1","
"
"1","-0.06365066 "
"1","
"
"1","
"
"1","$R2
"
"1"," CPLE6.SA "
"1","
"
"1","0.1958888 "
"1","
"
"1","
"
